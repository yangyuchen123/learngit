# 中断
## 中断过程
+ 中断发生：CPU处理A时B发生
+ 中断处理：CPU暂停A处理B
+ 中断返回：处理完B继续处理A
## 中断作用
+ 速度匹配：可以解决CPU与外部设备速度差的矛盾
+ 分时操作：CPU为多个外部设备服务提高计算机的利用效率
+ 实时响应：随时处理随机事件
+ 可靠性高：CPU可处理故障等突发事件，提高可靠性。

## 中断优先级
+ 优先处理高级中断

## 中断服务程序
+ 响应特定中断时，CPU执行的函数叫中断服务程序
+ 中断向量：即中断服务程序在内存中入口地址

## 中断处理流程
+ 查找中断向量：编号，查表，执行。
+ 发出中断请求——》判断是否允许中断——》优先级排队——》暂停当前程序，保护当前断点位置和处理器当前状态转到对应中断服务程序——》执行中断服务程序——》恢复被保护的状态回到被中断程序
+ 引脚分组（16个）
+ 尾号相同的引脚一组接一个外部中断线
+ 同组引脚只能有一个设置为外部中断功能
## HAL库中断的调用流程
1. 设置中断触发条件
2. 设置中断优先级
3. 使能外设中断
4. 清除中断标志
5. 编写中断服务程序
+ HAL库对中断的封装
  1. 统一中断服务程序HAL_PPP_IRQHandler
  2. 在HAL_PPP_IRQHandler中完成中断标志的判断与清除
  3. 将中断中需要执行的操作以回调函数的形式提供给用户
  4. 外部中断回调函数——处理具体的中断任务
## Mode的取值范围（对于外部中断增加的取值）
+ 上升沿触发：GPIO_MOED_IT_RISING
+ 下降沿触发：GPIO_MOED_IT_FALLING
+ 双边沿触发：GPIO_MOED_IT_RISING_FALLING

## 操作流程
1. 确定按键对应引脚及效果
2. 引脚配置灯为OUPUT，LD2。按键为GPIO_EXTI（），B1_EXTI
3. 外设配置：灯正常配置，按键配置触发方式
4. 使能外部中断线：NVIC中选ENABLED
5. 配置外部中断优先级：在NVIC标签中设置为优先级为15
6. 在USERCODE4中间加
  + void HAL_GPIO_EXIT_Callback(uint16_t GPIO_Pin)
  + if(GPIO_Pin==B1_EXTI_Pin)
  + HAL_GPIO_Togglepin(LD2_GPIO_Port,LD2_pin)




